<!DOCTYPE html>
<html ng-app="catsvsdogs">
  <head>
    <meta charset="utf-8" />
    <title>Cats vs Dogs -- Vote & Results</title>
    <base href="/index.html" />
    <meta name="viewport" content="width=device-width, initial-scale = 1.0" />
    <link rel="stylesheet" href="/stylesheets/style.css" />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css"
    />
  </head>

  <body ng-controller="statsCtrl">
    <div id="background-stats">
      <div id="background-stats-1"></div>
      <div id="background-stats-2"></div>
    </div>
    <div id="content-container">
      <div id="content-container-center">
        <!-- Error Display -->
        <div ng-if="error" id="error-container">
          <div class="error-message">
            <h2>⚠️ Application Error</h2>
            <p><strong>{{error.message}}</strong></p>
            <p class="error-detail">{{error.detail}}</p>
            <p class="error-code" ng-if="error.code">
              Error Code: {{error.code}}
            </p>
          </div>
        </div>

        <!-- Voting Interface -->
        <div ng-if="!error && !votingDisabled" id="voting-section">
          <h3>{{optionA}} vs {{optionB}}!</h3>
          <div id="voting-choice">
            <button
              id="vote-a"
              ng-click="submitVote('a')"
              ng-class="{'voted': userVote === 'a'}"
              ng-disabled="isVoting"
              class="vote-button a"
            >
              {{optionA}}
              <i ng-if="userVote === 'a'" class="fa fa-check-circle"></i>
            </button>
            <button
              id="vote-b"
              ng-click="submitVote('b')"
              ng-class="{'voted': userVote === 'b'}"
              ng-disabled="isVoting"
              class="vote-button b"
            >
              {{optionB}}
              <i ng-if="userVote === 'b'" class="fa fa-check-circle"></i>
            </button>
          </div>
          <div id="voting-tip">
            <span ng-if="!userVote">(Click to vote)</span>
            <span ng-if="userVote">(You can change your vote)</span>
          </div>
          <div
            ng-if="votingMessage"
            id="voting-message"
            ng-class="votingMessageClass"
          >
            {{votingMessage}}
          </div>
        </div>

        <!-- Results Display -->
        <div ng-if="!error" id="results-section">
          <h3>Live Results</h3>
          <div id="choice">
            <div class="choice cats">
              <div class="label">{{optionA}}</div>
              <div class="stat">{{aPercent | number:1}}%</div>
            </div>
            <div class="divider"></div>
            <div class="choice dogs">
              <div class="label">{{optionB}}</div>
              <div class="stat">{{bPercent | number:1}}%</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="result">
      <span ng-if="total == 0">No votes yet</span>
      <span ng-if="total == 1">{{total}} vote</span>
      <span ng-if="total >= 2">{{total}} votes</span>
    </div>
    <script src="socket.io.js"></script>
    <script src="angular.min.js"></script>
    <script src="app.js"></script>
  </body>
</html>
